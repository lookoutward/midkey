import{J as C}from"./JSEncrypt-CjdzDn6l.js";import{C as h}from"./index-5U5ddZpO.js";import{T as B}from"./TabBar-tyP81WnQ.js";import{_ as H,r as S,c as I,a as e,w as a,b as c,F as R,d as o,p as U,e as J,o as N,f as l}from"./index-BAHzZ0lp.js";import{T as d}from"./function-call-DvBReIUP.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./interceptor-VzhM6d2V.js";const i=m=>(U("data-v-8145aaf8"),m=m(),J(),m),F={class:"button-container"},G={class:"button-container"},j={class:"button-container"},q=i(()=>o("div",{class:"usage-scenarios"},[o("span",{class:"bold"},"RSA-2048-Signature:"),o("div",null,[l(" 1. Private key signature;"),o("br"),l(" 2. Public key verification. ")])],-1)),D=i(()=>o("div",null," ",-1)),L=i(()=>o("div",null," ",-1)),M=i(()=>o("div",null," ",-1)),O=i(()=>o("div",null," ",-1)),Q=i(()=>o("div",null," ",-1)),W=i(()=>o("div",null," ",-1)),X=i(()=>o("div",null," ",-1)),Y={__name:"SignPage",setup(m){const p=S(""),r=S(""),v=S(""),_=S(""),P=()=>{const n=new C({default_key_size:2048});n.getKey(),v.value=n.getPrivateKey(),_.value=n.getPublicKey(),d("Key pair generated!")},k=()=>{const n=new C;n.setPrivateKey(v.value.trim());const t=h.SHA256(p.value).toString();r.value=n.sign(t,h.SHA256,"sha256"),console.log("Signature:",r.value)},x=()=>{const n=new C;n.setPublicKey(_.value.trim());const t=h.SHA256(p.value).toString(),b=n.verify(t,r.value,h.SHA256);console.log("Verification Result:",b),d(b?"Signature verified successfully":"Signature verification failed")},y=n=>{const t=document.createElement("textarea");document.body.appendChild(t),t.value=n,t.select(),document.execCommand("copy"),document.body.removeChild(t)},K=()=>{y(v.value),d("The private key has been copied")},T=()=>{y(_.value),d("The public key has been copied")},w=()=>{y(p.value),d("The plaintext has been copied")},A=()=>{y(r.value),d("The signature has been copied")};return(n,t)=>{const b=c("van-nav-bar"),s=c("van-button"),f=c("van-field"),g=c("van-cell-group"),V=c("van-divider"),z=c("van-cell"),E=c("van-page");return N(),I(R,null,[e(E,null,{default:a(()=>[e(b,{title:"RSA-2048-Signature"}),o("div",F,[e(s,{type:"primary",onClick:k},{default:a(()=>[l("Private Key Signature")]),_:1})]),e(g,null,{default:a(()=>[e(f,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=u=>p.value=u),label:"Clear Text",type:"textarea",placeholder:"Clear text to be signed"},{button:a(()=>[e(s,{size:"mini",onClick:w},{default:a(()=>[l("Copy")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(g,null,{default:a(()=>[e(f,{modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=u=>r.value=u),label:"Signature Result",type:"textarea",placeholder:"Signature result"},{button:a(()=>[e(s,{size:"mini",onClick:A},{default:a(()=>[l("Copy")]),_:1})]),_:1},8,["modelValue"])]),_:1}),o("div",G,[e(s,{type:"primary",onClick:x},{default:a(()=>[l("Public Key Verification")]),_:1})]),e(V),e(g,null,{default:a(()=>[e(f,{modelValue:v.value,"onUpdate:modelValue":t[2]||(t[2]=u=>v.value=u),label:"Private Key",type:"textarea",placeholder:"Enter private key when signing"},{button:a(()=>[e(s,{size:"mini",onClick:K},{default:a(()=>[l("Copy")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(g,null,{default:a(()=>[e(f,{modelValue:_.value,"onUpdate:modelValue":t[3]||(t[3]=u=>_.value=u),label:"Public Key",type:"textarea",placeholder:"Enter public key during verification"},{button:a(()=>[e(s,{size:"mini",onClick:T},{default:a(()=>[l("Copy")]),_:1})]),_:1},8,["modelValue"])]),_:1}),o("div",j,[e(s,{type:"primary",onClick:P},{default:a(()=>[l("Generate Key Pair")]),_:1})]),e(V),e(z,null,{default:a(()=>[q]),_:1})]),_:1}),D,L,M,O,Q,W,X,e(B)],64)}}},ie=H(Y,[["__scopeId","data-v-8145aaf8"]]);export{ie as default};
