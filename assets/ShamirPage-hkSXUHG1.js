var ae=Object.defineProperty;var ce=(t,e,r)=>e in t?ae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var b=(t,e,r)=>ce(t,typeof e!="symbol"?e+"":e,r);import{_ as ie,c as q,a as u,w as y,b as w,F as J,r as R,d as m,p as le,e as fe,o as K,f as U,g as he,h as ue}from"./index-D6NhogfC.js";import{T as P}from"./function-call-0jRSpOIR.js";import"./interceptor-_EER2UW3.js";const de=29,ye=128,N=8,O=2**N,$=2,C=O-1,F="utf8",Y="binary",ee=new TextEncoder,pe=new TextDecoder,Q="0123456789abcdef",te=new Array(256);for(let t=0;t<16;++t){const e=t*16;for(let r=0;r<16;++r)te[e+r]=Q[t]+Q[r]}const z=64*1024,M=new Set([Int8Array.prototype,Int16Array.prototype,Int32Array.prototype,BigInt64Array.prototype,Uint8Array.prototype,Uint16Array.prototype,Uint32Array.prototype,BigUint64Array.prototype,Float32Array.prototype,Float64Array.prototype]);function me(t){if(t<0||!Number.isFinite(t)||!Number.isSafeInteger(t))throw new RangeError(`The argument 'byteLength' is invalid: Received ${t}`);return new f(t)}function g(t){return t?t instanceof ArrayBuffer||ArrayBuffer.isView(t)||Array.isArray(t)||typeof t=="object"&&"length"in t&&typeof t.length=="number":!1}function D(t,e=null){if(!g(t))return!1;if(typeof e=="function"&&M.has(e.prototype)){const n=Object.getPrototypeOf(t);return n===e.prototype||e.prototype.isPrototypeOf(n)}const r=Object.getPrototypeOf(t);for(const n of M)if(n===r||n.isPrototypeOf(r))return!0;return!1}function B(t){return t?t.constructor===ArrayBuffer||ArrayBuffer.prototype.isPrototypeOf(Object.getPrototypeOf(t)):!1}function E(t,e="utf8"){if(typeof t=="string")return e==="hex"?t.length>>>1:e==="utf8"?ee.encode(t).byteLength:t.length;if(!g(t))return 0;if("byteLength"in t)return t.byteLength;if("length"in t){for(const r of t)if(!Number.isFinite(r)||!Number.isInteger(r)||!Number.isSafeInteger(r))return 0;return t.length}return 0}function j(t){return g(t)?B(t)?t:D(t)||B(t.buffer)?t.buffer:null:null}function re(...t){if(t.length===0)return null;if(t.length===1&&Array.isArray(t[0]))return re(...t[0]);for(const i of t)if(!g(i))return null;let e,r;const n=t.shift();if(n==null)return null;const s=n.constructor,o=[n].concat(t).map(i=>E(i)).reduce((i,l)=>i+l,0);if(s===ArrayBuffer||ArrayBuffer.prototype.isPrototypeOf(Object.getPrototypeOf(n))){if(r=new s(o),r.byteLength!==o)throw new TypeError("Unable to correctly allocate output buffer");e=new Uint8Array(r)}else if(s===Array||Array.isArray(n)||Array.prototype.isPrototypeOf(Object.getPrototypeOf(n))){if(r=new s(o),E(r)!==o)throw new TypeError("Unable to correctly allocate output buffer");const i=j(r);e=B(i)?new Uint8Array(i):Uint8Array.from(r)}else if(D(n)){if(r=new s(o),r.byteLength!==o)throw new TypeError("Unable to correctly allocate output buffer");const i=j(r);e=new Uint8Array(i)}else{if(r=new s(o),E(r)!==o)throw new TypeError("Unable to correctly allocate output buffer");const i=j(r);e=B(i)?new Uint8Array(i):Uint8Array.from(r)}const c=[n].concat(t);let a=0;for(;c.length;){const i=j(c.shift());if(!i)throw new TypeError("Unable to determine ArrayBuffer in arguments");const l=new Uint8Array(i);e.set(l,a),a+=l.byteLength}return r}function H(t,e=t.byteOffset||0,r=E(t),n="utf8"){if(typeof t=="string"){if(n==="hex"){r=E(t,"hex");const s=new f(r);for(let o=0;o<t.length;++o){const c=2*o,a=parseInt(t.slice(c,c+2),16);if(Number.isNaN(a))break;s[o]=a}return s}if(n==="base64"){const s=globalThis.atob(t),o=new f(s.length);for(let c=0;c<s.length;++c)o[c]=s.charCodeAt(c);return o}return H(ee.encode(t))}if(g(t)){const s=j(t);if(B(s))return new f(s,t.byteOffset||e,r)}return Array.isArray(t)?new f(t):new f(0)}function I(t,e,r,n="utf8"){return typeof e=="string"?(n=e,H(t,0,E(t),n)):H(t,e||0,r||E(t),n)}function ge(t,e,r="utf8"){if((t instanceof Uint8Array||Uint8Array.prototype.isPrototypeOf(Object.getPrototypeOf(t)))&&(t=I(t,t.byteOffset,t.byteLength)),(e instanceof Uint8Array||Uint8Array.prototype.isPrototypeOf(Object.getPrototypeOf(e)))&&(e=I(e,e.byteOffset,e.byteLength)),typeof t=="string"&&(t=I(t,r)),typeof e=="string"&&(e=I(e,r)),!g(t)||!g(e))throw new TypeError('Input buffers must be "buffer like"');if(t===e)return 0;B(t)&&(t=I(t)),B(e)&&(e=I(e));let n=t.byteLength,s=e.byteLength;for(let o=0,c=Math.min(n,s);o<c;++o)if(t[o]!==e[o]){n=t[o],s=e[o];break}return n<s?-1:s<n?1:0}function be(t,e="utf8"){const r=I(t);if(e==="hex"){const n=[];for(let s=0;s<r.byteLength;++s)n.push(te[r[s]]);return n.join("")}if(e==="base64"){const n=[];for(let s=0;s<r.byteLength;++s)n.push(String.fromCharCode(r[s]));return globalThis.btoa(n.join(""))}return pe.decode(r)}function we(t){var n;const e=[];if(typeof((n=globalThis.crypto)==null?void 0:n.getRandomValues)!="function")throw new TypeError("Missing globalThis.crypto.getRandomValues implementation");if(t<=0||!Number.isFinite(t)||!Number.isSafeInteger(t))throw new RangeError(`The argument 'byteLength' is invalid: Received ${t}`);let r=t;do{const s=r>z?z:r,o=globalThis.crypto.getRandomValues(new Int8Array(s)),c=f.from(o);e.push(c),r=Math.max(0,r-z)}while(r>0);return f.concat(e)}const T=class T extends Uint8Array{static get Buffer(){return T}static isBuffer(e){return D(e,this)||D(e,Uint8Array)}get length(){return this.byteLength}toString(e="utf8"){return be(this,e)}toJSON(){return{type:"Buffer",data:Array.from(this)}}};b(T,"alloc",me),b(T,"byteLength",E),b(T,"compare",ge),b(T,"concat",re),b(T,"from",I),b(T,"isBufferLike",g),b(T,"random",we);let f=T;M.add(f.prototype);const _e=new Array(4*O).join("0"),V=new Array(O).fill(0),G=new Array(O).fill(0);for(let t=0,e=1;t<O;++t)G[t]=e,V[e]=t,e=e<<1,e>=O&&(e=e^de,e=e&C);function x(t,e=N){const r=f.from(t).toString();if(e===0)return r;e||(e=N);const n=r?r.length%e:0;if(n){const s=-1*(e-n+r.length);return(_e+r).slice(s)}return r}function Ae(t,e=F){const r=2*$;if(e||(e=F),typeof t=="string")return n(t);if(g(t))return s(f.from(t));throw new TypeError("Expecting a string or buffer as input.");function n(o){const c=[];if(F===e)for(let a=0;a<o.length;++a){const i=String.fromCharCode(o[a].toString(16)),l=x(i,r);c.unshift(l)}if(Y===e){o=x(t,4);for(let a=o.length;a>=4;a-=4){const i=o.slice(a-4,a),l=parseInt(i,2).toString(16);c.unshift(l)}}return c.join("")}function s(o){const c=[];for(let a=0;a<o.length;++a){const i=o[a].toString(16),l=x(i,r);c.unshift(l)}return c.join("")}}function ve(t,e=16){const r=[];e||(e=16);const n=f.byteLength(t);for(let s=n-1;s>=0;--s){let o;if(g(t)&&(o=t[s]),typeof t=="string"&&(o=parseInt(t[s],e)),Array.isArray(t)&&(o=t[s],typeof o=="string"&&(o=parseInt(o,e))),o===void 0)throw new TypeError("Unsupported type for chunk in input.");const c=x(o.toString(2),4);r.unshift(c)}return r.join("")}function Te(t,e){t=typeof t=="number"?t:parseInt(f.from(t).toString(),16);const r=(O-1).toString(16).length,n=f.concat([f.from(N.toString(36).toUpperCase()),f.from(x(t.toString(16),r))]);return g(e)||(e=f.from(e)),f.concat([n,e])}function Se(t,e="utf8"){const r=2*$,n=x(f.from(t).toString(e),r),s=r,o=[];for(let c=0;c<n.length;c+=s){const a=n.slice(c,c+s),i=parseInt(a,16);o.unshift(i)}return f.from(o)}function Ce(t,e=0,r=2){const n=[],s=x(f.from(t).toString(),e);let o=0;for(o=s.length;o>N;o-=N){const c=s.slice(o-N,o),a=parseInt(c,r);n.push(a)}return n.push(parseInt(s.slice(0,o),r)),n}const A={bin:ve,decode:Se,encode:Te,hex:Ae,pad:x,split:Ce},Ie=O-1;class Ee{constructor(e=0,r=0,n=null){b(this,"id",0);b(this,"bits",0);b(this,"data","");this.id=typeof e=="number"?e:parseInt(e,16),this.bits=typeof r=="number"?r:parseInt(r,36),this.data=typeof n=="string"?n:""}static from(e=0,r=0,n=null){if(e!==null&&typeof e=="object"){const s=e;return new this(s.id,s.bits||r,s.data||n)}return new this(e||0,r||0,n)}}function xe(t){const e=new Ee,r=g(t)?f.from(t).toString("hex"):t,n=r[0]==="0"?r.slice(1):r;e.bits=parseInt(n.slice(0,1),36);const o=`^([a-kA-K3-9]{1})([a-fA-F0-9]{${Ie.toString(16).length}})([a-fA-F0-9]+)$`,c=new RegExp(o).exec(n);return c&&c.length&&(e.id=parseInt(c[2],16),e.data=c[3]),e}function Oe(t,e){const r=C;let n=0,s=0;for(let o=0;o<e[0].length;++o)if(e[1][o]){n=V[e[1][o]];for(let c=0;c<e[0].length;++c)if(o!==c){if(t===e[0][c]){n=-1;break}const a=V[t^e[0][c]]-V[e[0][o]^e[0][c]];n=(n+a+r)%r}s=s===-1?s:s^G[n]}return s}function ke(t){const e=[],r=[],n=[],s=t.length;for(let l=0;l<s;++l){const v=xe(t[l]);if(r.indexOf(v.id)===-1){r.push(v.id);const h=A.bin(v.data,16),p=A.split(h,0,2);for(let d=0;d<p.length;++d)n[d]||(n[d]=[]),n[d][r.length-1]=p[d]}}for(let l=0;l<n.length;++l){const v=Oe(0,[r,n[l]]),h=A.pad(v.toString(2));e.unshift(h)}const o=e.join(""),c=o.slice(1+o.indexOf("1")),a=A.hex(c,Y),i=A.decode(a);return f.from(i)}const _=new Array(2*C);function Ue(t,e){const r=C,n=e.length-1;let s=0;for(let o=n;o>=0;--o)s=s===0?e[o]:G[(V[t]+V[s])%r]^e[o];return s}function Ne(t,e){const r=e.random,n=[t],s=[],o=e.threshold,c=e.shares;for(let a=1;a<o;++a)n[a]=parseInt(r(1).toString("hex"),16);for(let a=1;a<1+c;++a)s[a-1]={x:a,y:Ue(a,n)};return s}function Be(t,e){if(!t)throw new TypeError("An input secret must be provided");const r=f.from(t);if(r.byteLength===0)throw new TypeError("Secret cannot be empty");if(!e||typeof e!="object")throw new TypeError("Expecting options to be an object.");if("shares"in e&&typeof e.shares!="number")throw new TypeError("Expecting shares to be a number.");if("threshold"in e&&typeof e.threshold!="number")throw new TypeError("Expecting threshold to be a number.");if(!Number.isFinite(e.shares)||!Number.isInteger(e.shares)||!Number.isSafeInteger(e.shares))throw new RangeError("Expecting shares to be a positive integer");if(!Number.isFinite(e.threshold)||!Number.isInteger(e.threshold)||!Number.isSafeInteger(e.threshold))throw new RangeError("Expecting threshold to be a positive integer");if(e.shares<=0||e.shares>C)throw new RangeError(`Shares must be 0 < shares <= ${C}.`);if(e.threshold<=0||e.threshold>e.shares)throw new RangeError(`Threshold must be 0 < threshold <= ${e.shares}.`);if(e.random!==null&&e.random!==void 0)throw new TypeError("Expecting random to be a function");typeof e.random!="function"&&(e.random=f.random);const n=A.hex(r),s=A.bin(n,16),o=A.split("1"+s,ye,2);for(let a=0;a<o.length;++a){const i=Ne(o[a],{shares:e.shares,threshold:e.threshold,random:e.random});for(let l=0;l<e.shares;++l){_[l]||(_[l]=i[l].x.toString(16));const v=i[l].y.toString(2),h=_[l+C]||"";_[l+C]=A.pad(v)+h}}for(let a=0;a<e.shares;++a){const i=_[a],l=A.hex(_[a+C],Y);_[a]=A.encode(i,l),_[a]=f.from("0"+_[a],"hex")}const c=_.slice(0,e.shares);return _.fill(0),c}const Z=t=>btoa(unescape(encodeURIComponent(t))),W=t=>decodeURIComponent(escape(atob(t))),Pe={setup(){const t=R(""),e=R(3),r=R(Array(5).fill("")),n=R(!1),s=R([1,2,3,4]),o=()=>{if(!t.value.trim()){P("Please enter the secret！");return}const h=Be(Z(t.value),{shares:5,threshold:e.value});r.value=h.map(p=>Z(p)),P("The secret has been successfully decomposed!")},c=()=>{const h=r.value.filter(d=>d!=="").map(d=>W(d));if(h.length<e.value){P("The number of sub-secrets does not reach the threshold！");return}const p=h.slice(0,e.value);try{const d=ke(p);t.value=W(d),n.value=!0,P("The secret has been successfully synthesized！")}catch(d){console.error("An error occurred: "+d.message),P("Failed to reconstruct the secret, number of sub-secrets did not meet the threshold！")}},a=h=>{const p=document.createElement("textarea");document.body.appendChild(p),p.value=h,p.select(),document.execCommand("copy"),document.body.removeChild(p)};return{secret:t,threshold:e,subKeys:r,generateKeys:o,combineKeys:c,copySubKeyToClipboard:h=>{a(r.value[h]),P(`The sub-secret ${h+1} has been copied`)},secretDialogVisible:n,thresholdOptions:s,onThresholdConfirm:h=>{e.value=h},onThresholdCancel:()=>{},copyToClipboard:a}}},k=t=>(le("data-v-7efff517"),t=t(),fe(),t),Ve={class:"button-container"},Re={class:"button-container"},je=k(()=>m("div",{style:{width:"100%"}},[m("span",{style:{"font-weight":"bold"}},"Secret sharing scenarios:"),m("div",{class:"use-cases"},[U(" 1.A company needs to protect its vault. If only one person knows the password to the vault, the password could be lost. If several people know the password, they may not always trust each other. In this case, Shamir's secret sharing scheme can be used to split the vault password, send the split passwords to authorized individuals, and set a threshold so that the vault can only be opened when the number of authorized personnel reaches the threshold. "),m("br"),U(" 2.This secret sharing scheme supports a maximum of 5 authorized individuals with a threshold of 2-4 people. Once the original secret has been revealed, it needs to be split again to protect the new secret the next time it is used. ")])],-1)),Le=k(()=>m("div",null," ",-1)),De=k(()=>m("div",null," ",-1)),Ke=k(()=>m("div",null," ",-1)),Fe=k(()=>m("div",null," ",-1)),ze=k(()=>m("div",null," ",-1)),Me=k(()=>m("div",null," ",-1)),He=k(()=>m("div",null," ",-1));function Ye(t,e,r,n,s,o){const c=w("van-nav-bar"),a=w("van-button"),i=w("van-field"),l=w("van-cell"),v=w("van-cell-title"),h=w("van-picker"),p=w("van-divider"),d=w("van-cell-group"),ne=w("van-dialog"),oe=w("van-toast"),se=w("van-page");return K(),q(J,null,[u(se,null,{default:y(()=>[u(c,{title:"Shamir Secret Sharing"}),u(d,null,{default:y(()=>[u(l,null,{default:y(()=>[u(i,{modelValue:n.secret,"onUpdate:modelValue":e[1]||(e[1]=S=>n.secret=S),placeholder:"Enter the secret; when synthesizing, the secret will be displayed",type:"textarea"},{button:y(()=>[u(a,{size:"mini",onClick:e[0]||(e[0]=S=>n.copyToClipboard(n.secret))},{default:y(()=>[U("Copy")]),_:1})]),_:1},8,["modelValue"])]),_:1}),u(l,null,{default:y(()=>[u(h,{modelValue:n.threshold,"onUpdate:modelValue":e[2]||(e[2]=S=>n.threshold=S),columns:n.thresholdOptions,onConfirm:n.onThresholdConfirm,onCancel:n.onThresholdCancel,"show-toolbar":!0},{default:y(()=>[u(v,null,{default:y(()=>[U("Choose Threshold")]),_:1})]),_:1},8,["modelValue","columns","onConfirm","onCancel"])]),_:1}),m("div",Ve,[u(a,{type:"primary",onClick:n.generateKeys},{default:y(()=>[U("Decompose Secret")]),_:1},8,["onClick"])]),u(p),u(d,null,{default:y(()=>[(K(!0),q(J,null,he(n.subKeys,(S,L)=>(K(),ue(l,{key:L},{default:y(()=>[u(i,{modelValue:n.subKeys[L],"onUpdate:modelValue":X=>n.subKeys[L]=X,placeholder:"Please enter the sub-secret",type:"textarea"},{button:y(()=>[u(a,{size:"mini",onClick:X=>n.copySubKeyToClipboard(L)},{default:y(()=>[U("Copy")]),_:2},1032,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024))),128))]),_:1})]),_:1}),m("div",Re,[u(a,{type:"primary",onClick:n.combineKeys},{default:y(()=>[U("Synthesize Secret")]),_:1},8,["onClick"])]),u(ne,{modelValue:n.secretDialogVisible,"onUpdate:modelValue":e[3]||(e[3]=S=>n.secretDialogVisible=S),title:"Secret","show-cancel-button":"",onCancel:e[4]||(e[4]=S=>n.secretDialogVisible=!1),onConfirm:e[5]||(e[5]=S=>n.secretDialogVisible=!1)},null,8,["modelValue"]),u(oe),u(l,null,{default:y(()=>[je]),_:1}),u(p)]),_:1}),Le,De,Ke,Fe,ze,Me,He],64)}const Qe=ie(Pe,[["render",Ye],["__scopeId","data-v-7efff517"]]);export{Qe as default};
