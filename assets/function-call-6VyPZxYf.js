import{v as b,N as L,s as S,O as re,P as ue,Q as V,R as de,S as P,T as fe,U as Y,r as B,m as R,x as M,V as Z,a as d,W,D as h,A as ve,X as $,Y as q,Z as Q,C as U,i as ye,$ as X,h as J,a0 as me,a1 as he,F as ge,a2 as I,a3 as Ce,K as j,a4 as Oe,L as ee,a5 as ke,a6 as we,a7 as be,a8 as Ie,a9 as Se,aa as Pe,ab as xe,ac as pe,ad as Te,I as ze,G as Be}from"./index-BQIvCUz5.js";import{c as Ae}from"./interceptor-Cvm7J6d3.js";let Le=2e3;const De=()=>++Le,Ee={show:Boolean,zIndex:S,overlay:b,duration:S,teleport:[String,Object],lockScroll:b,lazyRender:b,beforeClose:Function,overlayStyle:Object,overlayClass:L,transitionAppear:Boolean,closeOnClickOverlay:b};let p=0;const G="van-overflow-hidden";function _e(e,t){const o=re(),l="01",n="10",i=a=>{o.move(a);const c=o.deltaY.value>0?n:l,O=fe(a.target,e.value),{scrollHeight:C,offsetHeight:k,scrollTop:x}=O;let w="11";x===0?w=k>=C?"00":"01":x+k>=C&&(w="10"),w!=="11"&&o.isVertical()&&!(parseInt(w,2)&parseInt(c,2))&&Y(a,!0)},r=()=>{document.addEventListener("touchstart",o.start),document.addEventListener("touchmove",i,{passive:!1}),p||document.body.classList.add(G),p++},u=()=>{p&&(document.removeEventListener("touchstart",o.start),document.removeEventListener("touchmove",i),p--,p||document.body.classList.remove(G))},g=()=>t()&&r(),f=()=>t()&&u();ue(g),V(f),de(f),P(t,a=>{a?r():u()})}function te(e){const t=B(!1);return P(e,o=>{o&&(t.value=o)},{immediate:!0}),o=>()=>t.value?o():null}const[Ne,Re]=M("overlay"),Me={show:Boolean,zIndex:S,duration:S,className:L,lockScroll:b,lazyRender:b,customStyle:Object};var $e=R({name:Ne,props:Me,setup(e,{slots:t}){const o=B(),l=te(()=>e.show||!e.lazyRender),n=r=>{e.lockScroll&&Y(r,!0)},i=l(()=>{var r;const u=h(ve(e.zIndex),e.customStyle);return $(e.duration)&&(u.animationDuration=`${e.duration}s`),q(d("div",{ref:o,style:u,class:[Re(),e.className]},[(r=t.default)==null?void 0:r.call(t)]),[[Q,e.show]])});return Z("touchmove",n,{target:o}),()=>d(W,{name:"van-fade",appear:!0},{default:i})}});const Ue=U($e),je=h({},Ee,{round:Boolean,position:I("center"),closeIcon:I("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:I("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Ke,H]=M("popup");var Fe=R({name:Ke,inheritAttrs:!1,props:je,emits:["open","close","opened","closed","keydown","update:show","click-overlay","click-close-icon"],setup(e,{emit:t,attrs:o,slots:l}){let n,i;const r=B(),u=B(),g=te(()=>e.show||!e.lazyRender),f=ye(()=>{const s={zIndex:r.value};if($(e.duration)){const m=e.position==="center"?"animationDuration":"transitionDuration";s[m]=`${e.duration}s`}return s}),a=()=>{n||(n=!0,r.value=e.zIndex!==void 0?+e.zIndex:De(),t("open"))},c=()=>{n&&Ae(e.beforeClose,{done(){n=!1,t("close"),t("update:show",!1)}})},O=s=>{t("click-overlay",s),e.closeOnClickOverlay&&c()},C=()=>{if(e.overlay)return d(Ue,{show:e.show,class:e.overlayClass,zIndex:r.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0,onClick:O},{default:l["overlay-content"]})},k=s=>{t("click-close-icon",s),c()},x=()=>{if(e.closeable)return d(ee,{role:"button",tabindex:0,name:e.closeIcon,class:[H("close-icon",e.closeIconPosition),Oe],classPrefix:e.iconPrefix,onClick:k},null)},w=()=>t("opened"),se=()=>t("closed"),le=s=>t("keydown",s),ce=g(()=>{var s;const{round:m,position:A,safeAreaInsetTop:N,safeAreaInsetBottom:ie}=e;return q(d("div",j({ref:u,style:f.value,role:"dialog",tabindex:0,class:[H({round:m,[A]:A}),{"van-safe-area-top":N,"van-safe-area-bottom":ie}],onKeydown:le},o),[(s=l.default)==null?void 0:s.call(l),x()]),[[Q,e.show]])}),F=()=>{const{position:s,transition:m,transitionAppear:A}=e,N=s==="center"?"van-fade":`van-popup-slide-${s}`;return d(W,{name:m||N,appear:A,onAfterEnter:w,onAfterLeave:se},{default:ce})};return P(()=>e.show,s=>{s&&!n&&(a(),o.tabindex===0&&Ce(()=>{var m;(m=u.value)==null||m.focus()})),!s&&n&&(n=!1,t("close"))}),X({popupRef:u}),_e(u,()=>e.show&&e.lockScroll),Z("popstate",()=>{e.closeOnPopstate&&(c(),i=!1)}),J(()=>{e.show&&a()}),me(()=>{i&&(t("update:show",!0),i=!1)}),V(()=>{e.show&&e.teleport&&(c(),i=!0)}),ke(we,()=>e.show),()=>e.teleport?d(he,{to:e.teleport},{default:()=>[C(),F()]}):d(ge,null,[C(),F()])}});const Ge=U(Fe);function He(){const e=Ie({show:!1}),t=n=>{e.show=n},o=n=>{h(e,n,{transitionAppear:!0}),t(!0)},l=()=>t(!1);return X({open:o,close:l,toggle:t}),{open:o,close:l,state:e,toggle:t}}function Ve(e){const t=be(e),o=document.createElement("div");return document.body.appendChild(o),{instance:t.mount(o),unmount(){t.unmount(),document.body.removeChild(o)}}}let T=0;function Ye(e){e?(T||document.body.classList.add("van-toast--unclickable"),T++):T&&(T--,T||document.body.classList.remove("van-toast--unclickable"))}const[Ze,z]=M("toast"),We=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay"],qe={icon:String,show:Boolean,type:I("text"),overlay:Boolean,message:S,iconSize:S,duration:Se(2e3),position:I("middle"),teleport:[String,Object],className:L,iconPrefix:String,transition:I("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:L,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean};var oe=R({name:Ze,props:qe,emits:["update:show"],setup(e,{emit:t}){let o,l=!1;const n=()=>{const a=e.show&&e.forbidClick;l!==a&&(l=a,Ye(l))},i=a=>t("update:show",a),r=()=>{e.closeOnClick&&i(!1)},u=()=>clearTimeout(o),g=()=>{const{icon:a,type:c,iconSize:O,iconPrefix:C,loadingType:k}=e;if(a||c==="success"||c==="fail")return d(ee,{name:a||c,size:O,class:z("icon"),classPrefix:C},null);if(c==="loading")return d(pe,{class:z("loading"),size:O,type:k},null)},f=()=>{const{type:a,message:c}=e;if($(c)&&c!=="")return a==="html"?d("div",{key:0,class:z("text"),innerHTML:String(c)},null):d("div",{class:z("text")},[c])};return P(()=>[e.show,e.forbidClick],n),P(()=>[e.show,e.type,e.message,e.duration],()=>{u(),e.show&&e.duration>0&&(o=setTimeout(()=>{i(!1)},e.duration))}),J(n),Pe(n),()=>d(Ge,j({class:[z([e.position,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:r,onClosed:u,"onUpdate:show":i},xe(e,We)),{default:()=>[g(),f()]})}});const ne={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let v=[],_=!1,D=h({},ne);const E=new Map;function ae(e){return ze(e)?e:{message:e}}function Qe(){const{instance:e,unmount:t}=Ve({setup(){const o=B(""),{open:l,state:n,close:i,toggle:r}=He(),u=()=>{_&&(v=v.filter(f=>f!==e),t())},g=()=>d(oe,j(n,{onClosed:u,"onUpdate:show":r}),null);return P(o,f=>{n.message=f}),Be().render=g,{open:l,clear:i,message:o}}});return e}function Xe(){if(!v.length||_){const e=Qe();v.push(e)}return v[v.length-1]}function y(e={}){if(!Te)return{};const t=Xe(),o=ae(e);return t.open(h({},D,E.get(o.type||D.type),o)),t}const K=e=>t=>y(h({type:e},ae(t)));y.loading=K("loading");y.success=K("success");y.fail=K("fail");y.clear=e=>{var t;v.length&&(e?(v.forEach(o=>{o.clear()}),v=[]):_?(t=v.shift())==null||t.clear():v[0].clear())};function Je(e,t){typeof e=="string"?E.set(e,t):h(D,e)}y.setDefaultOptions=Je;y.resetDefaultOptions=e=>{typeof e=="string"?E.delete(e):(D=h({},ne),E.clear())};y.allowMultiple=(e=!0)=>{_=e};y.install=e=>{e.use(U(oe)),e.config.globalProperties.$toast=y};export{y as T};
